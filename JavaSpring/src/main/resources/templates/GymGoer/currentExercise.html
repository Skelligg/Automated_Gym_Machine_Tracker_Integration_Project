<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Current Exercise</title>
  <link rel="stylesheet" th:href="@{/css/routines-style.css}" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
        crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
          integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
          crossorigin="anonymous"></script>
</head>
<body th:object="${exercise}">

<div class="d-flex justify-content-end me-3">
  <form th:action="@{/activesession/{username}/finalise(username=${username})}" method="post">
    <input type="hidden" name="sessionId" th:value="${sessionId}" />
    <button type="submit" class="btn d-flex flex-column align-items-center">
      <svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" fill="currentColor" class="bi bi-x-circle-fill" viewBox="0 0 16 16">
        <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0M5.354 4.646a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0-.708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293z"/>
      </svg>
      <span class="mt-1">End Workout</span>
    </button>
  </form>
</div>


<div class="container-fluid mt-5">
  <div class="container col-lg-6 col-md-8 col-sm-10 mx-auto">
    <h1 class="text-center mb-4" th:text="*{exerciseName}">Exercise Name</h1>

<!--    &lt;!&ndash; Previous Set Information &ndash;&gt;-->
<!--    <div class="mb-3">-->
<!--      <h4>Previous Set</h4>-->
<!--      <p class="text-muted" th:text="${previousSet != null ? previousSet : 'No previous set recorded.'}">-->
<!--        No previous set recorded.-->
<!--      </p>-->
<!--    </div>-->
    <div class="text-center">
      <p>Predicted 10 Rep Working Weight: <span th:text="${tenPrediction} + ' kg'"></span></p>
      <p>Predicted 1 Rep Max: <span th:text="${onePrediction} + ' kg'"></span></p>
    </div>

    <!-- Current Sets -->
    <div>
      <h4>Current Sets</h4>
      <div class="list-group">
        <div class="list-group-item d-flex justify-content-between fw-bold">
          <span>Set #</span>
          <span>Reps</span>
          <span>Weight</span>
          <span>Time</span>
        </div>
        <div th:each="set : ${sets}" class="list-group-item d-flex justify-content-between">
          <span th:text="${set.setNumber}">1</span>
          <span th:text="${set.repetitionCount}">8</span>
          <span th:text="${set.weightCount}">50 kg</span>
          <span th:text="${set.endTime}">00:00</span>
        </div>
      </div>
    </div>

    <!-- Conditional Form for Next Exercise or End Session -->
    <div class="text-center mt-4">

      <!-- Link for Next Exercise -->
      <a th:if="${exerciseIndex < sessionSize - 1}"
         th:href="@{/activesession/{username}/nextExercise(sessionId=${sessionId}, exerciseIndex=${exerciseIndex + 1}, username=${username}, machineId=${machineId})}"
         class="btn btn-primary btn-lg rounded-pill px-5">
        Next Exercise
      </a>

      <!-- Form for End Session -->
      <form th:if="${exerciseIndex == sessionSize - 1}"
            th:action="@{/activesession/{username}/finalise(username=${username},sessionId=${sessionId})}"
            method="post">
        <button type="submit" class="btn btn-danger btn-lg rounded-pill px-5">
          End Session
        </button>
      </form>

    </div>


</body>
</html>
